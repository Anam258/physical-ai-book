"use strict";(globalThis.webpackChunkphysical_ai_handbook=globalThis.webpackChunkphysical_ai_handbook||[]).push([[652],{2015:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/ros2-network-3d946ed883f1cf28598d1c6f59ec1f53.png"},6459:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"Module-01-ROS2/ros2-fundamentals-2","title":"ROS 2 Fundamentals 2: Python Agents & rclpy","description":"* Master the rclpy library for Python-based ROS 2 development","source":"@site/docs/Module-01-ROS2/03-ros2-fundamentals-2.md","sourceDirName":"Module-01-ROS2","slug":"/Module-01-ROS2/ros2-fundamentals-2","permalink":"/physical-ai-book/docs/Module-01-ROS2/ros2-fundamentals-2","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Module-01-ROS2/03-ros2-fundamentals-2.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Fundamentals 1: Nodes, Topics, and Services","permalink":"/physical-ai-book/docs/Module-01-ROS2/ros2-fundamentals-1"},"next":{"title":"ROS 2 Fundamentals 3: URDF for Humanoids","permalink":"/physical-ai-book/docs/Module-01-ROS2/ros2-fundamentals-3"}}');var i=r(4848),t=r(8453);const o={},l="ROS 2 Fundamentals 2: Python Agents & rclpy",a={},c=[{value:"Getting Started with rclpy",id:"getting-started-with-rclpy",level:2},{value:"Basic Node Structure",id:"basic-node-structure",level:3},{value:"Creating Publishers and Subscribers",id:"creating-publishers-and-subscribers",level:2},{value:"Asynchronous Programming Patterns",id:"asynchronous-programming-patterns",level:2},{value:"Hands-on Lab",id:"hands-on-lab",level:2},{value:"Self-Assessment",id:"self-assessment",level:2}];function d(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"ros-2-fundamentals-2-python-agents--rclpy",children:"ROS 2 Fundamentals 2: Python Agents & rclpy"})}),"\n",(0,i.jsx)(n.admonition,{title:"Learning Objectives",type:"info",children:(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Master the rclpy library for Python-based ROS 2 development"}),"\n",(0,i.jsx)(n.li,{children:"Create Python nodes that interact with ROS 2 topics and services"}),"\n",(0,i.jsx)(n.li,{children:"Implement action servers and clients in Python"}),"\n",(0,i.jsx)(n.li,{children:"Understand asynchronous programming patterns in ROS 2 Python nodes"}),"\n"]})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Hero Diagram: Python Agents &amp; rclpy",src:r(2015).A+"",width:"688",height:"1024"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"rclpy"})," library provides Python bindings for ROS 2, enabling developers to create ROS 2 nodes using Python. Python's simplicity and rich ecosystem make it an excellent choice for rapid prototyping and development of robotic applications."]}),"\n",(0,i.jsx)(n.h2,{id:"getting-started-with-rclpy",children:"Getting Started with rclpy"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"rclpy"})," library serves as the Python client library for ROS 2, providing the interface between Python applications and the ROS 2 middleware. To begin using ",(0,i.jsx)(n.code,{children:"rclpy"}),", you need to initialize the library and create a node."]}),"\n",(0,i.jsx)(n.h3,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = MyNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Key Concept",type:"tip",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"rclpy.init()"})," function initializes the ROS 2 client library, and ",(0,i.jsx)(n.code,{children:"rclpy.spin()"})," keeps the node active, processing callbacks for subscriptions, services, and timers until the node is shut down."]})}),"\n",(0,i.jsx)(n.h2,{id:"creating-publishers-and-subscribers",children:"Creating Publishers and Subscribers"}),"\n",(0,i.jsx)(n.p,{children:"Working with topics in Python using rclpy involves creating publishers and subscribers within your node class:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass MinimalPublisher(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_publisher')\r\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = 'Hello World: %d' % self.i\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info('Publishing: \"%s\"' % msg.data)\r\n        self.i += 1\r\n\r\nclass MinimalSubscriber(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_subscriber')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'topic',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info('I heard: \"%s\"' % msg.data)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    minimal_publisher = MinimalPublisher()\r\n    minimal_subscriber = MinimalSubscriber()\r\n    rclpy.spin(minimal_publisher)\r\n    minimal_publisher.destroy_node()\r\n    minimal_subscriber.destroy_node()\r\n    rclpy.shutdown()\r\n\r\n## Working with Services in Python\r\n\r\nServices in ROS 2 provide synchronous request-response communication. Here's how to implement a service server and client in Python:\r\n\r\n```python\r\n# Service Server\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts\r\n\r\nclass MinimalService(Node):\r\n    def __init__(self):\r\n        super().__init__('minimal_service')\r\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\r\n\r\n    def add_two_ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info('Incoming request\\na: %d b: %d' % (request.a, request.b))\r\n        return response\n"})}),"\n",(0,i.jsx)(n.h2,{id:"asynchronous-programming-patterns",children:"Asynchronous Programming Patterns"}),"\n",(0,i.jsx)(n.p,{children:"ROS 2 Python nodes can leverage asyncio for handling multiple operations concurrently:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nimport asyncio\r\n\r\nclass AsyncNode(Node):\r\n    def __init__(self):\r\n        super().__init__('async_node')\r\n        # Using asyncio for concurrent operations\r\n        self.future = asyncio.Future()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"hands-on-lab",children:"Hands-on Lab"}),"\n",(0,i.jsx)(n.p,{children:"Create a Python-based ROS 2 system that:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Implements a publisher that sends sensor data"}),"\n",(0,i.jsx)(n.li,{children:"Creates a subscriber that processes this data"}),"\n",(0,i.jsx)(n.li,{children:"Develops a service server that performs calculations"}),"\n",(0,i.jsx)(n.li,{children:"Builds a client that calls the service"}),"\n",(0,i.jsx)(n.li,{children:"Uses asynchronous patterns for concurrent operations"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"self-assessment",children:"Self-Assessment"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"What is rclpy and why is it important for Python ROS 2 development?"}),"\n",(0,i.jsx)(n.li,{children:"How do you create a publisher and subscriber in Python using rclpy?"}),"\n",(0,i.jsx)(n.li,{children:"What are the advantages of using Python for ROS 2 development?"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var s=r(6540);const i={},t=s.createContext(i);function o(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);